import fetch from 'node-fetch';
import { xpRange } from '../lib/levelling.js'
import PhoneNumber from 'awesome-phonenumber'
import { promises } from 'fs'
import { join } from 'path'

let handler = async (m, { conn, usedPrefix, usedPrefix: _p, __dirname, text, isPrems }) => {
    try {
        let imgRes = await fetch('https://telegra.ph/file/d0804533786f9f57836db.jpg');
        let imgBuffer = await imgRes.buffer();
        let imgFileName = 'menu.jpg'; // Provide a filename for the image

        let d = new Date(new Date + 3600000)
        let locale = 'ar'
        let week = d.toLocaleDateString(locale, { weekday: 'long' })
        let date = d.toLocaleDateString(locale, { day: 'numeric', month: 'long', year: 'numeric' })
        let _uptime = process.uptime() * 1000
        let uptime = clockString(_uptime)
        let user = global.db.data.users[m.sender]
        let { money, joincount } = global.db.data.users[m.sender]
        let { exp, limit, level, role } = global.db.data.users[m.sender]
        let { min, xp, max } = xpRange(level, global.multiplier)
        let rtotalreg = Object.values(global.db.data.users).filter(user => user.registered == true).length 
        let more = String.fromCharCode(8206)
        let readMore = more.repeat(850)   
        let taguser = '@' + m.sender.split("@s.whatsapp.net")[0]
        let str = `
*ã€ŽðŒð€ð’ð“ð„ð‘ðŸŒŸã€*
â´âœ¾âµâ”€â”€â”â”â”â”â¨ðŸŒŸâ©â”â”â”â”â”€â”€â´âœ¾âµ
*â’â†µðŸ“† Ø§Ù„Ù€ØªÙ€Ø§Ø±ÙŠÙ€Ø®:ã€Ž${date}ã€*

*â’â†µâ³ÙˆÙ‚Ù€Øª Ù†Ù€Ø´Ù€Ø·:ã€Ž ${uptime}ã€*

*â’â†µðŸ‘¤Ù…Ù€Ø³Ù€ØªÙ€Ø®Ù€Ø¯Ù…Ù€ÙŠÙ€Ù†:ã€Ž${rtotalreg}ã€*

*â’â†µðŸ“Œ Ù…Ù€Ø³Ù€ØªÙ€ÙˆÙ‰:ã€Ž${level}ã€*

*â’â†µðŸ¤– Ø®Ù€Ø¨Ù€Ø±Ø©:ã€Ž${exp}ã€*

*â’â†µðŸ•·ï¸ Ø§Ù„Ù€Ø¯ÙˆØ±:ã€Ž${role}ã€*

â´âœ¾âµâ”€â”€â”â”â”â”â¨ðŸŒŸâ©â”â”â”â”â”€â”€â´âœ¾âµ

*â’â†µðŸ’Ž Ø§Ù„Ù€Ù…Ù€Ø§Ø³:ã€Ž${limit}ã€*

*â’â†µðŸ‘¾ Ø¹Ù€Ù…Ù€Ù„Ø§Øª:ã€Ž${money}ã€*

*â’â†µðŸª™ Ø§Ù„Ù€Ø±Ù…Ù€ÙˆØ²:ã€Ž${joincount}ã€*

*â’â†µðŸŽŸï¸Ù…Ù€Ù…Ù€ÙŠÙ€Ø²:ã€Ž${user.premiumTime > 0 ? 'âœ…' : (isPrems ? 'âœ…' : 'âŒ') || ''}ã€*

*â’â†µðŸŽ© ØªÙ€ÙÙ€Ø¶Ù€Ù„ Ø§Ù„Ù€Ù‚Ù€Ø§Ø¦Ù€Ù…Ù€Ø©:ã€Ž${taguser}ã€*

â´âœ¾âµâ”€â”€â”â”â”â”â¨ðŸŒŸâ©â”â”â”â”â”€â”€â´âœ¾âµ
*ðŸâ”‹â¬¤â†« Ø£ÙˆØ§Ù…Ù€ðŸ“ŒÙ€Ø± Ø§Ù„Ù€Ø®Ù€Ø§ØµÙ€Ø© Ø¨Ù€Ø§Ù„Ù€Ø¬Ù€Ø±ÙˆØ¨*
*ââ†µâ”‚Ø·Ø±Ø¯ðŸ¯* 
*ââ†µâ”‚ØªØ±Ù‚ÙŠØ©ðŸ¯*
*ââ†µâ”‚Ø§Ø¹ÙØ§Ø¡ðŸ¯*
*ââ†µâ”‚ØªØ­Ø°ÙŠØ±ðŸ¯*
*ââ†µâ”‚Ø­Ø°Ù_ØªØ­Ø°ÙŠØ±ðŸ¯*
*ââ†µâ”‚Ø­Ø°ÙðŸ¯*
*ââ†µâ”‚Ù…Ù†Ø´Ù†ðŸ¯*
*ââ†µâ”‚Ù…Ø®ÙÙŠðŸ¯*
*ââ†µâ”‚Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†ðŸ¯*
*ââ†µâ”‚Ù„Ù…Ù†Ø´Ù†ðŸ¯*
*ââ†µâ”‚Ø¨Ø±ÙˆÙØ§ÙŠÙ„ðŸ¯*
*ââ†µâ”‚Ø§Ù„Ø¬Ø±ÙˆØ¨ðŸ¯*
*ââ†µâ”‚Ø¯Ø¹ÙˆÙ‡ðŸ¯*
*ââ†µâ”‚ØªØºÙŠÙŠØ±_Ø§Ù„Ù„ÙŠÙ†ÙƒðŸ¯*
*ââ†µâ”‚Ù„ÙÙ„ðŸ¯*
*ââ†µâ”‚Ø§Ù„ØªØ±Ø­ÙŠØ¨ðŸ¯*
*ââ†µâ”‚Ø§Ù„Ù…ØºØ§Ø¯Ø±Ù‡ðŸ¯*
*ââ†µâ”‚Ø§ÙŠØ§ØªðŸ¯*
*ââ†µâ”‚Ø¬Ø±ÙˆØ¨ Ù‚ÙÙ„  ÙØªØ­ðŸ¯*
*ââ†µâ”‚Ø®Ø·ðŸ¯*
*ââ†µâ”‚Ù„ÙŠÙ†ÙƒðŸ¯*
*ââ†µâ”‚ÙŠÙˆÙ…ÙŠðŸ¯*
*ââ†µâ”‚Ø§Ù„Ù…Ø§Ø³ðŸ¯*
*ââ†µâ”‚ØªØ±ØªÙŠØ¨_Ø§Ù„Ø¨Ù†ÙƒðŸ¯*
*ââ†µâ”‚Ø´Ø±Ø§Ø¡ðŸ¯*
*ââ†µâ”‚Ù‡Ø¬ÙˆÙ…ðŸ¯*
â—‚ â”â”â”â”â”„à¼»ðŸŒŸà¼ºâ”„â”â”â”â” â–¸
*ðŸâ”‹â¬¤â†«Ù‚Ù€Ø³Ù€Ù… Ø§Ù„Ø¯ÙŠÙ€Ù†Ù€ÙŠ*
*ââ†µâ”‚Ø­Ø¯ÙŠØ«ðŸ“¿*
*ââ†µâ”‚Ù‚Ø±Ø§Ù†ðŸ“¿*
*ââ†µâ”‚Ø§Ù„Ù„Ù‡ðŸ“¿*
*ââ†µâ”‚Ø¯ÙŠÙ†ðŸ“¿*
â—‚ â”â”â”â”â”„à¼»ðŸŒŸà¼ºâ”„â”â”â”â” â–¸
*ðŸŒâ”‹â¬¤â†« Ø£ÙˆØ§Ù…Ù€ðŸ“ŒÙ€Ø± Ø§Ù„Ù€Ø®Ù€Ø§ØµÙ€Ø© Ø¨Ù€Ø§Ù„Ù€Ù…Ø¤Ø³Ù€Ø³Ù€ÙŠÙ€Ù†*
*ââ†µâ”‚Ø¨Ø±ÙŠÙ…ðŸª½*
*ââ†µâ”‚Ø­Ø°Ù_Ø¨Ø±ÙŠÙ…ðŸª½*
*ââ†µâ”‚Ø¨Ø§Ù†ðŸª½*
*ââ†µâ”‚ÙÙƒðŸª½*
*ââ†µâ”‚Ø§Ø·ÙØ§Ø¡ðŸª½*
*ââ†µâ”‚ØªÙØ¹ÙŠÙ„ðŸª½*
*ââ†µâ”‚Ø§Ù„Ù…Ø¨Ù†Ø¯ÙŠÙ†ðŸª½*
*ââ†µâ”‚Ø¥Ø¹Ø§Ø¯Ø©ðŸª½*
*ââ†µâ”‚Ø§Ø¹Ø§Ø¯Ø©ØªØ´ØºÙŠÙ„ðŸª½*
*ââ†µâ”‚Ø£Ø¯Ø®Ù„ðŸª½*
*ââ†µâ”‚Ø¶ÙŠÙ_Ø§ÙƒØ³_Ø¨ÙŠðŸª½*
*ââ†µâ”‚Ø¶ÙŠÙ_Ø¬ÙˆØ§Ù‡Ø±ðŸª½*
â—‚ â”â”â”â”â”„à¼»ðŸŒŸà¼ºâ”„â”â”â”â” â–¸
*ðŸŒâ”‹â¬¤â†« Ø§Ù„Ù€Ù€Ù€ØªÙ€Ø±ÙÙ€Ù€ÙŠÙ€Ù‡ ðŸŽ®*
*ââ†µâ”‚Ø§ÙƒØ³ Ø§Ùˆ*
*ââ†µâ”‚ØµØ±Ø§Ø­Ù‡*
*ââ†µâ”‚ÙƒØª*
*ââ†µâ”‚Ù„Ùˆ*
*ââ†µâ”‚Ù‡Ù„*
*ââ†µâ”‚ØªØ±Ø¬Ù…*
*ââ†µâ”‚Ø§Ø­Ø²Ø±*
*ââ†µâ”‚Ø²ÙˆØ§Ø¬*
*ââ†µâ”‚Ø§Ù†Ø·Ù‚*
*ââ†µâ”‚ØªØ§Ø¬*
*ââ†µâ”‚Ø­ÙƒÙ…Ù‡*
*ââ†µâ”‚Ù…ÙŠÙ…Ø²*
*ââ†µâ”‚Ø³ÙˆØ§Ù„*
â—‚ â”â”â”â”â”„à¼»ðŸŒŸà¼ºâ”„â”â”â”â” â–¸
*ðŸ“Šâ”‹â¬¤â†« Ø§Ù„Ù€ØªØ­Ù€ÙˆÙŠÙ„ ðŸ”ƒ*
*ââ†µâ”‚Ù…Ù„ØµÙ‚ðŸŽ—ï¸*
*ââ†µâ”‚Ø³Ø±Ù‚Ø©ðŸŽ—ï¸*
*ââ†µâ”‚Ù„ÙÙŠØ¯ÙŠÙˆðŸŽ—ï¸*
*ââ†µâ”‚Ù„ØµÙˆØ±Ø©ðŸŽ—ï¸*
*ââ†µâ”‚Ù„Ø§Ù†Ù…ÙŠðŸŽ—ï¸*
*ââ†µâ”‚ØªØ®ÙŠÙ„ðŸŽ—ï¸*
*ââ†µâ”‚Ù…ÙƒØ³ðŸŽ—ï¸*
*ââ†µâ”‚Ù„Ø¬ÙˆØ§Ù‡Ø±ðŸŽ—ï¸*
*ââ†µâ”‚Ø³ØªÙƒðŸŽ—ï¸*
*ââ†µâ”‚ØªÙ„Ø¬Ø±Ø§ÙðŸŽ—ï¸*
*ââ†µâ”‚Ù„ÙƒØ±ØªÙˆÙ†ðŸŽ—ï¸*
*ââ†µâ”‚Ø¨Ø§Ø±ÙƒÙˆØ¯ðŸŽ—ï¸*
â—‚ â”â”â”â”â”„à¼»ðŸŒŸà¼ºâ”„â”â”â”â” â–¸
*ðŸ‘‘â”‹â¬¤â†« Ø§Ù„Ù€ØµÙˆØªÙ€ÙŠØ§Øª ðŸ“¢*
*ââ†µâ”‚Ø¹Ù…ÙŠÙ‚ðŸ“Ž*
*ââ†µâ”‚Ù…Ù†ÙÙˆØ®ðŸ“Ž*
*ââ†µâ”‚ØªØ®ÙŠÙ†ðŸ“Ž*
*ââ†µâ”‚ØµØ§Ø®Ø¨ðŸ“Ž*
*ââ†µâ”‚Ø³Ø±ÙŠØ¹ðŸ“Ž*
*ââ†µâ”‚ØªØ®ÙŠÙ†Ù†ðŸ“Ž*
*ââ†µâ”‚Ø±ÙÙŠØ¹ðŸ“Ž*
*ââ†µâ”‚Ø±ÙˆØ¨ÙˆØªðŸ“Ž*
*ââ†µâ”‚Ø¨Ø·ÙŠØ¡ðŸ“Ž*
*ââ†µâ”‚Ù†Ø§Ø¹Ù…ðŸ“Ž*
*ââ†µâ”‚Ø³Ù†Ø¬Ø§Ø¨ðŸ“Ž*
â´âœ¾âµâ”€â”€â”â”â”â”â¨ðŸŒŸâ©â”â”â”â”â”€â”€â´âœ¾âµ



`.trim()

        // Send image and caption together
        await conn.sendFile(m.chat, imgBuffer, imgFileName, str, m, false, { thumbnail: Buffer.alloc(0) });

    } catch (error) {
        console.error(error);
        conn.reply(m.chat, '[â—Ø®Ø·Ø§Ø¡â—]', m);
    }
}

handler.command = /^(help|Ø§Ù„Ø§ÙˆØ§Ù…Ø±|menu|Ø£ÙˆØ§Ù…Ø±|menu|Ø§ÙˆØ§Ù…Ø±)$/i
handler.exp = 20
handler.fail = null

export default handler

function clockString(ms) {
    let h = isNaN(ms) ? '--' : Math.floor(ms / 3600000)
    let m = isNaN(ms) ? '--' : Math.floor(ms / 60000) % 60
    let s = isNaN(ms) ? '--' : Math.floor(ms / 1000) % 60
    return [h, m, s].map(v => v.toString().padStart(2, 0)).join(':')
}

